<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NextGen Gadgets - All Products</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
       
        :root {
            --primary: #4f46e5; 
            --primary-light: #6366f1;
            --primary-dark: #4338ca;
            --secondary: #f59e0b;
            --accent: #10b981; 
            --text-dark: #1f2937; 
            --text-light: #f9fafb; 
            --bg-light: #f9fafb; 
            --bg-medium: #e5e7eb; 
            --card-bg: #ffffff;
            --border-color: #e5e7eb;
            --shadow-sm: rgba(0, 0, 0, 0.05);
            --shadow-md: rgba(0, 0, 0, 0.1);
            --shadow-lg: rgba(0, 0, 0, 0.2);
            --danger: #ef4444; 
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .container {
            width: 100%;
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Header */
        header {
            background: var(--text-dark);
            color: var(--text-light);
            padding: 18px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 15px var(--shadow-md);
            transition: all 0.3s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--text-light);
            text-decoration: none;
            cursor: pointer;
        }

        .logo i {
            color: var(--secondary);
            transition: transform 0.3s ease;
        }

        .logo:hover i {
            transform: rotate(15deg) scale(1.1);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 36px;
            align-items: center;
        }

        nav a {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 500;
            font-size: 1.05rem;
            transition: color 0.3s ease, transform 0.3s ease;
            position: relative;
            padding: 8px 0;
        }

        nav a:hover {
            color: var(--secondary);
            transform: translateY(-3px);
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background-color: var(--secondary);
            transition: width 0.3s ease;
        }

        nav a:hover::after {
            width: 100%;
        }

        .nav-icons {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .icon-btn {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.5rem;
            cursor: pointer;
            position: relative;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .icon-btn:hover {
            color: var(--secondary);
            transform: scale(1.1);
        }

        .cart-count, .notification-count {
            position: absolute;
            top: -8px;
            right: -10px;
            background-color: var(--accent);
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: bounceIn 0.5s ease-out;
        }

        @keyframes bounceIn {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); }
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.8rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .mobile-menu-btn:hover {
            transform: rotate(90deg);
        }

        /* Section Common Styles */
        section {
            padding: 100px 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 70px;
        }

        .section-title h2 {
            font-size: 3.5rem;
            color: var(--text-dark);
            position: relative;
            display: inline-block;
            margin-bottom: 20px;
            font-weight: 800;
        }

        .section-title h2::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 5px;
            background: var(--primary);
            border-radius: 3px;
        }

        .section-title p {
            color: var(--gray);
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.15rem;
        }

        /* Category Section Styling */
        .category-section {
            margin-bottom: 80px; /* Space between categories */
        }

        .category-section h3 {
            font-size: 2.8rem;
            color: var(--primary-dark);
            text-align: center;
            margin-bottom: 50px;
            font-weight: 800;
            position: relative;
            display: inline-block;
            width: 100%; /* Ensure it takes full width for centering */
        }

        .category-section h3::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--secondary);
            border-radius: 2px;
        }

        /* Products Section */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* Fixed 3 columns */
            gap: 40px;
        }

        .product-card {
            background: var(--card-bg);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 25px var(--shadow-sm);
            transition: transform 0.3s ease, box-shadow 0.3s ease, scale 0.3s ease;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .product-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 20px 40px var(--shadow-md);
        }

        .product-image {
            height: 250px; /* Fixed height for consistent image size */
            overflow: hidden;
            position: relative;
            cursor: pointer;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ensures image covers the area, cropping if necessary */
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image img {
            transform: scale(1.1);
        }

        .product-info {
            padding: 28px;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .product-category {
            color: var(--primary);
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .product-title {
            font-size: 1.5rem; /* Decreased font size for product name */
            margin-bottom: 15px;
            color: var(--text-dark);
            font-weight: 700;
        }

        .product-price {
            font-size: 2rem;
            font-weight: 800;
            color: var(--text-dark);
            margin-bottom: 20px;
            display: flex;
            align-items: baseline;
            gap: 10px;
        }

        .product-price span {
            color: var(--gray);
            font-size: 1.2rem;
            text-decoration: line-through;
            font-weight: 400;
        }

        .product-rating {
            color: var(--secondary);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        .product-rating .fas {
            margin-right: 3px;
        }

        .add-to-cart {
            display: block;
            width: 100%;
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.3s ease;
            font-size: 1.15rem;
        }

        .add-to-cart:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--shadow-sm);
        }

        /* Footer */
        footer {
            background: var(--text-dark);
            color: var(--text-light);
            padding: 70px 0 35px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 50px;
            margin-bottom: 50px;
        }

        .footer-column h3 {
            font-size: 1.6rem;
            margin-bottom: 28px;
            position: relative;
            padding-bottom: 15px;
            color: var(--text-light);
            font-weight: 700;
        }

        .footer-column h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: var(--secondary);
            border-radius: 2px;
        }

        .footer-column p {
            color: #cbd5e1;
            line-height: 1.7;
            font-size: 1rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 16px;
        }

        .footer-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: color 0.3s ease, transform 0.3s ease;
            display: inline-block;
            font-size: 1.05rem;
        }

        .footer-links a:hover {
            color: var(--secondary);
            transform: translateX(10px);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 35px;
            border-top: 1px solid #334155;
            color: #94a3b8;
            font-size: 0.95rem;
        }

        .footer-column .form-group {
            margin-bottom: 0;
        }
        .footer-column .form-group input {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            color: white;
        }
        .footer-column .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        .footer-column .btn {
            width: 100%;
            text-align: center;
            padding: 14px 25px;
            font-size: 1.05rem;
            margin-top: 15px;
        }

        /* Quick View Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background-color: var(--card-bg);
            padding: 40px;
            border-radius: 20px;
            width: 95%;
            max-width: 900px;
            box-shadow: 0 15px 40px var(--shadow-lg);
            position: relative;
            transform: translateY(30px);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--gray);
            cursor: pointer;
            transition: color 0.3s ease, transform 0.3s ease;
        }
        .modal-close-btn:hover {
            color: var(--text-dark);
            transform: rotate(90deg);
        }

        .modal-image {
            flex: 1;
            min-width: 300px;
            max-width: 48%;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 20px var(--shadow-sm);
        }
        .modal-image img {
            width: 100%;
            height: auto;
            display: block;
        }

        .modal-details {
            flex: 1;
            min-width: 350px;
        }
        .modal-details .product-category {
            font-size: 1.1rem;
            margin-bottom: 12px;
        }
        .modal-details .product-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 800;
        }
        .modal-details .product-price {
            font-size: 2.5rem;
            margin-bottom: 25px;
            font-weight: 800;
        }
        .modal-details .product-rating {
            font-size: 1.3rem;
            margin-bottom: 25px;
        }
        .modal-details p {
            color: var(--gray);
            margin-bottom: 25px;
            line-height: 1.7;
            font-size: 1.05rem;
        }
        .modal-details .quantity-selector {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        .quantity-selector label {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 1.1rem;
        }
        .quantity-selector input {
            width: 80px;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            text-align: center;
            font-size: 1.1rem;
            -moz-appearance: textfield; /* Firefox */
        }
        .quantity-selector input::-webkit-outer-spin-button,
        .quantity-selector input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .quantity-selector button {
            background: var(--primary);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            font-size: 1.4rem;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }
        .quantity-selector button:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }
        .modal-add-to-cart {
            width: 100%;
            padding: 18px;
            font-size: 1.3rem;
            border-radius: 12px;
        }

        /* New button style for AI feature */
        .ai-feature-btn {
            display: block;
            width: 100%;
            background: #6b7280; /* Gray background */
            color: white;
            border: none;
            padding: 14px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.3s ease;
            font-size: 1.15rem;
            margin-top: 15px; /* Space from add to cart button */
        }

        .ai-feature-btn:hover {
            background: #4b5563; /* Darker gray on hover */
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--shadow-sm);
        }

        .ai-feature-btn:disabled {
            background-color: #d1d5db;
            cursor: not-allowed;
            opacity: 0.7;
        }


        /* Cart Modal Styles */
        #cartModal .modal-content {
            max-width: 1000px;
            flex-direction: column;
            align-items: center;
        }
        #cartModal .modal-details {
            width: 100%;
            min-width: unset;
        }
        .cart-items-container {
            width: 100%;
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
        }
        .cart-item {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--card-bg);
            transition: background-color 0.2s ease;
        }
        .cart-item:last-child {
            border-bottom: none;
        }
        .cart-item:hover {
            background-color: var(--bg-light);
        }
        .cart-item-image {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
        }
        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .cart-item-details {
            flex-grow: 1;
        }
        .cart-item-details h4 {
            font-size: 1.2rem;
            margin-bottom: 5px;
            color: var(--text-dark);
        }
        .cart-item-details p {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }
        .cart-item-price {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }
        .cart-item-quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .cart-item-quantity-controls input {
            width: 60px;
            padding: 5px 8px;
            font-size: 1rem;
            border-radius: 5px;
        }
        .cart-item-quantity-controls button {
            width: 30px;
            height: 30px;
            font-size: 1rem;
            border-radius: 5px;
        }
        .remove-from-cart {
            background-color: var(--danger);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .remove-from-cart:hover {
            background-color: #c23333;
        }
        .cart-summary {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        .cart-summary div {
            display: flex;
            justify-content: space-between;
        }
        .cart-summary .total {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary-dark);
        }
        .checkout-btn {
            width: 100%;
            margin-top: 30px;
            padding: 15px;
            font-size: 1.3rem;
            background-color: var(--accent);
            border-color: var(--accent);
        }
        .checkout-btn:hover {
            background-color: #0d9266;
            border-color: #0d9266;
        }
        .empty-cart-message {
            text-align: center;
            padding: 50px;
            color: var(--gray);
            font-size: 1.2rem;
        }

        /* Auth Modal Styles */
        #authModal .modal-content {
            max-width: 500px;
            padding: 40px; /* Increased padding */
            text-align: center;
            background: linear-gradient(145deg, var(--card-bg), var(--bg-light)); /* Gradient background */
            border-radius: 25px; /* More rounded */
            box-shadow: 0 15px 40px rgba(0,0,0,0.25); /* Stronger shadow */
            animation: scaleIn 0.3s ease-out forwards; /* New animation */
        }

        @keyframes scaleIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        #authModal .modal-content h3 {
            font-size: 2.5rem; /* Larger title */
            margin-bottom: 30px; /* Increased margin */
            color: var(--primary-dark);
            font-weight: 800;
            position: relative;
        }
        #authModal .modal-content h3::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--secondary);
            border-radius: 2px;
        }
        #authModal .form-group {
            margin-bottom: 25px; /* Increased margin */
        }
        #authModal .form-group label {
            font-size: 1.1rem;
            color: var(--text-dark);
            text-align: left;
            width: 100%;
        }
        #authModal .form-group input {
            padding: 14px 20px; /* Increased padding */
            border-radius: 12px; /* More rounded inputs */
            border: 1px solid var(--border-color);
            background-color: var(--bg-light);
            font-size: 1.05rem;
            box-shadow: inset 0 1px 3px var(--shadow-sm);
        }
        #authModal .form-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.3);
        }
        #authModal .btn {
            width: 100%;
            margin-top: 25px; /* Increased margin */
            padding: 15px; /* Increased padding */
            font-size: 1.2rem;
            border-radius: 12px; /* More rounded buttons */
            background: var(--primary);
            box-shadow: 0 5px 15px var(--shadow-sm);
        }
        #authModal .btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px var(--shadow-md);
        }
        #authModal .toggle-auth-mode {
            font-size: 1rem; /* Slightly larger text */
            margin-top: 20px; /* Increased margin */
            color: var(--primary);
            font-weight: 600;
        }
        #authModal .toggle-auth-mode:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        #authModal .error-message {
            color: var(--danger);
            font-size: 1rem; /* Slightly larger error message */
            margin-top: 15px;
            font-weight: 500;
        }
        .user-greeting {
            color: var(--accent);
            font-weight: 600;
            margin-right: 15px;
            font-size: 1.1rem;
        }

        /* Back to Top Button */
        #back-to-top {
            display: none;
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--primary);
            color: white;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.6rem;
            cursor: pointer;
            box-shadow: 0 5px 15px var(--shadow-md);
            transition: background-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease;
            z-index: 999;
            opacity: 0;
            transform: translateY(20px);
        }
        #back-to-top.show {
            opacity: 1;
            transform: translateY(0);
        }
        #back-to-top:hover {
            background-color: var(--primary-dark);
            transform: translateY(-8px) scale(1.05);
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
            .section-title h2 {
                font-size: 3rem;
            }
            .category-section h3 {
                font-size: 2.5rem;
            }
            .modal-image {
                max-width: 100%;
            }
            .modal-content {
                flex-direction: column;
                max-width: 90%;
                padding: 30px;
            }
            .modal-image, .modal-details {
                min-width: unset;
                max-width: 100%;
            }
            .products-grid {
                grid-template-columns: repeat(2, 1fr); /* 2 columns on tablets */
            }
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }

            nav ul {
                position: fixed;
                top: 75px; /* Adjust based on header height */
                left: -100%;
                background: var(--text-dark);
                width: 100%;
                flex-direction: column;
                align-items: center;
                padding: 30px 0;
                transition: left 0.4s ease-in-out;
                box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
            }

            nav ul.active {
                left: 0;
            }

            nav ul li {
                margin-bottom: 25px;
            }
            nav ul li:last-child {
                margin-bottom: 0;
            }
            nav ul a {
                font-size: 1.3rem;
                padding: 10px 0;
            }
            .nav-icons {
                display: none; /* Hide icons in mobile menu, show only in header */
            }
            .header-content .nav-icons {
                display: flex; /* Keep icons in header even if menu is open */
            }

            .section-title h2 {
                font-size: 2.5rem;
            }
            .section-title p {
                font-size: 1.05rem;
            }
            .category-section h3 {
                font-size: 2rem;
            }

            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
            .footer-column h3::after {
                left: 50%;
                transform: translateX(-50%);
            }
            .footer-links {
                padding: 0;
            }

            .modal-content {
                padding: 25px;
            }
            .modal-details .product-title {
                font-size: 2.2rem;
            }
            .modal-details .product-price {
                font-size: 2.2rem;
            }
            .cart-item {
                flex-wrap: wrap;
                justify-content: center;
                text-align: center;
            }
            .cart-item-details, .cart-item-quantity-controls {
                width: 100%;
                justify-content: center;
            }
            .cart-item-image {
                margin-bottom: 10px;
            }

            #authModal .modal-content {
                padding: 25px;
            }
            #authModal .modal-content h3 {
                font-size: 2rem;
            }
            .products-grid {
                grid-template-columns: 1fr; /* 1 column on mobile */
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 16px;
            }
            .logo {
                font-size: 1.8rem;
            }
            .icon-btn {
                font-size: 1.3rem;
            }
            .mobile-menu-btn {
                font-size: 1.6rem;
            }
            .btn {
                padding: 12px 30px;
                font-size: 1rem;
            }
            .section-title h2 {
                font-size: 2rem;
            }
            .category-section h3 {
                font-size: 1.8rem;
            }
            .product-title {
                font-size: 1.3rem; /* Further decreased for very small screens */
            }
            .product-price {
                font-size: 1.6rem;
            }
            .add-to-cart {
                font-size: 1rem;
            }
            #back-to-top {
                width: 48px;
                height: 48px;
                font-size: 1.4rem;
                bottom: 25px;
                right: 25px;
            }
            .modal-content {
                padding: 20px;
            }
            .modal-details .product-title {
                font-size: 1.8rem;
            }
            .modal-details .product-price {
                font-size: 1.8rem;
            }
            .modal-close-btn {
                font-size: 1.5rem;
                top: 10px;
                right: 10px;
            }
            .cart-item-details h4 {
                font-size: 1.1rem;
            }
            .cart-item-price {
                font-size: 1rem;
            }
            #authModal .modal-content {
                padding: 20px;
            }
            #authModal .modal-content h3 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">
                <i class="fas fa-bolt"></i>
                <span>NextGen Gadgets</span>
            </a>
            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="categories.html">Categories</a></li>
                    <li><a href="index.html#about">About Us</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                    <li class="nav-icons">
                        <span id="userGreeting" class="user-greeting" style="display: none;"></span>
                        <button class="icon-btn" id="loginBtn" title="Login / Register">
                            <i class="fas fa-user-circle"></i>
                        </button>
                        <button class="icon-btn" id="cartBtn" title="View Cart">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="cart-count">0</span>
                        </button>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <!-- Products Section -->
        <section id="products">
            <div class="container">
                <div class="section-title">
                    <h2>Our Featured Products</h2>
                    <p>Handpicked for performance, innovation, and value.</p>
                </div>

                <!-- Category Section: Smartphones -->
                <div class="category-section">
                    <h3>Smartphones</h3>
                    <div class="products-grid" id="smartphonesGrid">
                        <!-- Smartphone products will be dynamically loaded here by JavaScript -->
                    </div>
                </div>

                <!-- Category Section: Laptops -->
                <div class="category-section">
                    <h3>Laptops</h3>
                    <div class="products-grid" id="laptopsGrid">
                        <!-- Laptop products will be dynamically loaded here by JavaScript -->
                    </div>
                </div>

                <!-- Category Section: Audio Devices -->
                <div class="category-section">
                    <h3>Audio Devices</h3>
                    <div class="products-grid" id="audioGrid">
                        <!-- Audio products will be dynamically loaded here by JavaScript -->
                    </div>
                </div>

            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>NextGen Gadgets</h3>
                    <p>Your ultimate destination for cutting-edge electronics and smart gadgets. Innovation, quality, and exceptional service.</p>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="products.html">Products</a></li>
                        <li><a href="categories.html">Categories</a></li>
                        <li><a href="index.html#about">About Us</a></li>
                        <li><a href="index.html#contact">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Customer Service</h3>
                    <ul class="footer-links">
                        <li><a href="#">FAQs</a></li>
                        <li><a href="#">Shipping Policy</a></li>
                        <li><a href="#">Returns & Refunds</a></li>
                        <li><a href="#">Order Tracking</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Stay Connected</h3>
                    <p>Subscribe to our newsletter for exclusive offers and tech news!</p>
                    <div class="form-group">
                        <input type="email" placeholder="Enter your email">
                        <button class="btn">Subscribe</button>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 NextGen Gadgets. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Quick View Modal (Shared) -->
    <div class="modal-overlay" id="quickViewModal">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeQuickViewModalBtn"><i class="fas fa-times"></i></button>
            <div class="modal-image">
                <img id="modalProductImage" src="" alt="Product Image" onerror="this.onerror=null; this.src='https://placehold.co/600x400/CCCCCC/000000?text=Image+Not+Found';">
            </div>
            <div class="modal-details">
                <div class="product-category" id="modalProductCategory"></div>
                <h3 class="product-title" id="modalProductTitle"></h3>
                <div class="product-price" id="modalProductPrice"></div>
                <div class="product-rating" id="modalProductRating"></div>
                <p id="modalProductDescription"></p>
                <div class="quantity-selector">
                    <label for="modalProductQuantity">Quantity:</label>
                    <button id="decreaseModalQuantity">-</button>
                    <input type="number" id="modalProductQuantity" value="1" min="1">
                    <button id="increaseModalQuantity">+</button>
                </div>
                <button class="btn modal-add-to-cart" id="modalAddToCartBtn">Add to Cart</button>
                <button class="ai-feature-btn" id="generateDescriptionBtn">âœ¨ Enhance Description</button>
            </div>
        </div>
    </div>

    <!-- Shopping Cart Modal (Shared) -->
    <div class="modal-overlay" id="cartModal">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeCartModalBtn"><i class="fas fa-times"></i></button>
            <h3>Your Shopping Cart</h3>
            <div class="cart-items-container" id="cartItemsContainer">
                <!-- Cart items will be loaded here -->
            </div>
            <div class="cart-summary">
                <div>Subtotal: <span id="cartSubtotal">Rs.0</span></div>
                <div>Shipping: <span id="cartShipping">Rs.0</span></div>
                <div class="total">Total: <span id="cartTotal">Rs.0</span></div>
            </div>
            <button class="btn checkout-btn">Proceed to Checkout</button>
        </div>
    </div>

    <!-- Login/Register Modal (Shared) -->
    <div class="modal-overlay" id="authModal">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeAuthModalBtn"><i class="fas fa-times"></i></button>
            <h3 id="authModalTitle">Login</h3>
            <form id="authForm">
                <div class="form-group">
                    <label for="authUsername">Username:</label>
                    <input type="text" id="authUsername" placeholder="Enter your username" required>
                </div>
                <div class="form-group">
                    <label for="authPassword">Password:</label>
                    <input type="password" id="authPassword" placeholder="Enter your password" required>
                </div>
                <div class="form-group" id="confirmPasswordGroup" style="display: none;">
                    <label for="authConfirmPassword">Confirm Password:</label>
                    <input type="password" id="authConfirmPassword" placeholder="Confirm your password" required>
                </div>
                <button type="submit" class="btn" id="authSubmitBtn">Login</button>
                <p class="error-message" id="authErrorMessage" style="display: none;"></p>
                <button type="button" class="toggle-auth-mode" id="toggleAuthMode">Don't have an account? Register</button>
            </form>
        </div>
    </div>

    <!-- Back to Top Button (Shared) -->
    <button id="back-to-top" title="Back to Top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>
        // --- Global State ---
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        // Product data is now organized by category
        const categoriesData = {
            "Smartphones": [
                {
                    id: 'prod1',
                    name: 'iPhone 15 Pro Max',
                    category: 'Smartphone',
                    price: 129999,
                    oldPrice: 149999,
                    rating: 5,
                    image: 'https://images.unsplash.com/photo-1695423617346-613d0387b99c?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHNlYXJjaHwxfHxpcGhvbmUlMjAxNSUyMHBybyUyMG1heHxlbnwwfHx8fDE3MjE4MzY4MDB8MA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'The latest flagship from Apple, featuring the A17 Bionic chip, ProMotion display, and an advanced camera system for unparalleled performance and photography.'
                },
                {
                    id: 'prod9',
                    name: 'Samsung Galaxy S24 Ultra',
                    category: 'Smartphone',
                    price: 119999,
                    oldPrice: 135000,
                    rating: 4.8,
                    image: 'https://images.unsplash.com/photo-1707010530740-496662496a7d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHNhbXN1bmclMjBnYWxheHklMjBzMjQlMjB1bHRyYXxlbnwwfHx8fDE3MjE4MzY4MDF8MA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Experience the pinnacle of Android technology with the Galaxy S24 Ultra, featuring an incredible camera, powerful processor, and S Pen integration.'
                },
                {
                    id: 'prod10',
                    name: 'Google Pixel 8 Pro',
                    category: 'Smartphone',
                    price: 89999,
                    oldPrice: 99999,
                    rating: 4.7,
                    image: 'https://images.unsplash.com/photo-1697223405370-9d041c2a0487?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxnb29nbGUlMjBwaXxlbCUyMDglMjBwcm98ZW58MHx8fHwxNzIxODM2ODAxfDA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Unlock the power of Google AI with the Pixel 8 Pro, offering an exceptional camera, smooth performance, and a pure Android experience.'
                },
                {
                    id: 'prod11',
                    name: 'OnePlus 12',
                    category: 'Smartphone',
                    price: 64999,
                    oldPrice: 70000,
                    rating: 4.6,
                    image: 'https://images.unsplash.com/photo-1705886326126-78b191295b7c?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxvbmVwbHVzJTIwMTJ8ZW58MHx8fHwxNzIxODM2ODAxfDA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Fast and fluid, the OnePlus 12 delivers top-tier performance, a stunning display, and rapid charging for an uninterrupted mobile experience.'
                },
                {
                    id: 'prod12',
                    name: 'Xiaomi 14',
                    category: 'Smartphone',
                    price: 58999,
                    oldPrice: 65000,
                    rating: 4.5,
                    image: 'https://images.unsplash.com/photo-1699925695844-482a875a5c13?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHx4aWFvbWklMjAxNHxlbnwwfHx8fDE3MjE4MzY4MDJ8MA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'The Xiaomi 14 combines powerful hardware with a sleek design, offering a premium smartphone experience at a competitive price.'
                },
                {
                    id: 'prod21',
                    name: 'Realme GT 5 Pro',
                    category: 'Smartphone',
                    price: 52999,
                    oldPrice: 58000,
                    rating: 4.4,
                    image: 'https://images.unsplash.com/photo-1707010530740-496662496a7d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxyZWFsbWUlMjBndCUyMDV8ZW58MHx8fHwxNzIxODQxNjAwfDA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'A performance-focused smartphone with a vibrant display and fast charging, ideal for gaming and heavy usage.'
                }
            ],
            "Laptops": [
                {
                    id: 'prod2',
                    name: 'Dell XPS 15',
                    category: 'Laptop',
                    price: 98000,
                    oldPrice: 120000,
                    rating: 4.5,
                    image: 'https://images.unsplash.com/photo-1611078489956-6110f3710a9a?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHhkZWxsJTIweHBzJTIwMTV8ZW58MHx8fHwxNzIxODM2ODAyfDA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'A premium laptop known for its stunning InfinityEdge display, powerful Intel processor, and sleek design. Perfect for creative professionals and power users.'
                },
                {
                    id: 'prod13',
                    name: 'MacBook Air M3',
                    category: 'Laptop',
                    price: 105000,
                    oldPrice: 115000,
                    rating: 4.9,
                    image: 'https://images.unsplash.com/photo-1707010530740-496662496a7d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxtYWNib29rJTIwYWlyJTIwbTN8ZW58MHx8fHwxNzIxODM2ODAxfDA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Ultra-portable and incredibly powerful, the MacBook Air with M3 chip handles demanding tasks with ease, offering exceptional battery life.'
                },
                {
                    id: 'prod14',
                    name: 'HP Spectre x360',
                    category: 'Laptop',
                    price: 89000,
                    oldPrice: 98000,
                    rating: 4.6,
                    image: 'https://images.unsplash.com/photo-1603302576837-37561323fc9a?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxocCUyMHNwZWN0cmUlMjB4MzYwfGVufDB8fHx8MTcyMTgzNjgwMnww&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'A versatile 2-in-1 laptop with a stunning design, powerful performance, and a vibrant touchscreen, perfect for work and creativity.'
                },
                {
                    id: 'prod15',
                    name: 'Lenovo ThinkPad X1 Carbon',
                    category: 'Laptop',
                    price: 110000,
                    oldPrice: 125000,
                    rating: 4.7,
                    image: 'https://images.unsplash.com/photo-1601053424183-f81d120a1c1d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxsZW5vdm8lMjB0aGlua3BhZCUyMHgxJTIwY2FyYm9ufGVufDB8fHx8MTcyMTgzNjgwM3ww&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'The ultimate business laptop, combining legendary durability, top-tier security features, and lightweight design for professionals on the go.'
                },
                {
                    id: 'prod16',
                    name: 'Asus ROG Zephyrus G14',
                    category: 'Laptop',
                    price: 130000,
                    oldPrice: 145000,
                    rating: 4.8,
                    image: 'https://images.unsplash.com/photo-1616071427210-e17f766e4a2e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxhc3VzJTIwcm9nJTIwemVwaHlydXMlMjBnMTR8ZW58MHx8fHwxNzIxODM2ODA0fDA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'A compact yet powerful gaming laptop, featuring a high-refresh-rate display and robust graphics for an immersive gaming experience.'
                },
                {
                    id: 'prod22',
                    name: 'Microsoft Surface Laptop 5',
                    category: 'Laptop',
                    price: 95000,
                    oldPrice: 105000,
                    rating: 4.4,
                    image: 'https://images.unsplash.com/photo-1679078768045-8c7c9e0c521f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHNlYXJjaHwxfHxtaWNyb3NvZnQlMjBzdXJmYWNlJTIwbGFwdG9wJTIwNXxlbnwwfHx8fDE3MjE4NDI0MDB8MA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Sleek and portable, the Surface Laptop 5 offers a premium feel and strong performance for everyday tasks and creative work.'
                }
            ],
            "Audio Devices": [
                {
                    id: 'prod3',
                    name: 'Sony WH-1000XM5',
                    category: 'Audio',
                    price: 28999,
                    oldPrice: 34999,
                    rating: 5,
                    image: 'https://images.unsplash.com/photo-1678170044573-0f72382f6412?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxzb255JTIwd2gtMTAwMHhtNXxlbnwwfHx8fDE3MjE4MzY4MDR8MA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Industry-leading noise-canceling headphones with exceptional sound quality, comfortable design, and smart features for an immersive listening experience.'
                },
                {
                    id: 'prod17',
                    name: 'Apple AirPods Pro 2',
                    category: 'Audio',
                    price: 24900,
                    oldPrice: 26900,
                    rating: 4.7,
                    image: 'https://images.unsplash.com/photo-1695423617346-613d0387b99c?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxhcHBsZSUyMGFpcnBvZHMlMjBwcm8lMjAyfGVufDB8fHx8MTcyMTgzNjgwNXww&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Enhanced Active Noise Cancellation, Adaptive Transparency, and Spatial Audio make the AirPods Pro 2 an unparalleled wireless earbud experience.'
                },
                {
                    id: 'prod18',
                    name: 'Bose QuietComfort Earbuds II',
                    category: 'Audio',
                    price: 26999,
                    oldPrice: 29999,
                    rating: 4.6,
                    image: 'https://images.unsplash.com/photo-1667035540306-03704259b329?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHhib3NlJTIwcXVpZXRjb21mb3J0JTIwZWFyYnVkcyUyMGlpfGVufDB8fHx8MTcyMTgzNjgwNnww&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'World-class noise cancellation and a comfortable, secure fit for an immersive listening experience wherever you go.'
                },
                {
                    id: 'prod19',
                    name: 'Sennheiser Momentum 4 Wireless',
                    category: 'Audio',
                    price: 30999,
                    oldPrice: 35000,
                    rating: 4.8,
                    image: 'https://images.unsplash.com/photo-1667035540306-03704259b329?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxzZW5uaGVpc2VyJTIwbW9tZW50dW0lMjA0JTIwd2lyZWxlc3N8ZW58MHx8fHwxNzIxODM2ODA2fDA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Exceptional sound quality, adaptive noise cancellation, and a long-lasting battery make these headphones perfect for audiophiles.'
                },
                {
                    id: 'prod20',
                    name: 'JBL Flip 6',
                    category: 'Audio',
                    price: 9999,
                    oldPrice: 12000,
                    rating: 4.5,
                    image: 'https://images.unsplash.com/photo-1627401198466-419b7d8d4791?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHhqYmwlMjBmbGlwJTIwNnxlbnwwfHx8fDE3MjE4MzY4MDd8MA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Portable waterproof speaker with powerful sound and vibrant colors, perfect for outdoor adventures and parties.'
                },
                {
                    id: 'prod23',
                    name: 'Google Pixel Buds Pro',
                    category: 'Audio',
                    price: 18999,
                    oldPrice: 20000,
                    rating: 4.6,
                    image: 'https://images.unsplash.com/photo-1658514120300-3e2b2f7d7e3c?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1NzI5MjZ8MHwxfHxnb29nbGUlMjBwaXxlbCUyMGJ1ZHMlMjBwcm98ZW58MHx8fHwxNzIxODQyNDAxfDA&ixlib=rb-4.0.3&q=80&w=600',
                    description: 'Smart and comfortable earbuds with active noise cancellation and seamless integration with the Google ecosystem.'
                }
            ]
        };

        // Flatten products for cart/quick view consistency (used by modals)
        const products = Object.values(categoriesData).flat();

        const users = JSON.parse(localStorage.getItem('users')) || {}; // Simulated user database

        // --- DOM Elements ---
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const navMenu = document.querySelector('nav ul');
        const cartCountSpan = document.querySelector('.cart-count');
        // Products grids for each category
        const smartphonesGrid = document.getElementById('smartphonesGrid');
        const laptopsGrid = document.getElementById('laptopsGrid');
        const audioGrid = document.getElementById('audioGrid');
        const userGreeting = document.getElementById('userGreeting');

        // Modals
        const quickViewModal = document.getElementById('quickViewModal');
        const closeQuickViewModalBtn = document.getElementById('closeQuickViewModalBtn');
        const cartModal = document.getElementById('cartModal');
        const closeCartModalBtn = document.getElementById('closeCartModalBtn');
        const authModal = document.getElementById('authModal');
        const closeAuthModalBtn = document.getElementById('closeAuthModalBtn');

        // Quick View Modal Elements
        const modalProductImage = document.getElementById('modalProductImage');
        const modalProductCategory = document.getElementById('modalProductCategory');
        const modalProductTitle = document.getElementById('modalProductTitle');
        const modalProductPrice = document.getElementById('modalProductPrice');
        const modalProductRating = document.getElementById('modalProductRating');
        const modalProductDescription = document.getElementById('modalProductDescription');
        const modalProductQuantityInput = document.getElementById('modalProductQuantity');
        const decreaseModalQuantityBtn = document.getElementById('decreaseModalQuantity');
        const increaseModalQuantityBtn = document.getElementById('increaseModalQuantity');
        const modalAddToCartBtn = document.getElementById('modalAddToCartBtn');
        const generateDescriptionBtn = document.getElementById('generateDescriptionBtn'); // New AI button

        // Cart Modal Elements
        const cartItemsContainer = document.getElementById('cartItemsContainer');
        const cartSubtotalSpan = document.getElementById('cartSubtotal');
        const cartShippingSpan = document.getElementById('cartShipping');
        const cartTotalSpan = document.getElementById('cartTotal');
        const checkoutBtn = document.querySelector('.checkout-btn');

        // Auth Modal Elements
        const loginBtn = document.getElementById('loginBtn');
        const authModalTitle = document.getElementById('authModalTitle');
        const authForm = document.getElementById('authForm');
        const authUsernameInput = document.getElementById('authUsername');
        const authPasswordInput = document.getElementById('authPassword');
        const authConfirmPasswordInput = document.getElementById('authConfirmPassword');
        const confirmPasswordGroup = document.getElementById('confirmPasswordGroup');
        const authSubmitBtn = document.getElementById('authSubmitBtn');
        const authErrorMessage = document.getElementById('authErrorMessage');
        const toggleAuthModeBtn = document.getElementById('toggleAuthMode');
        let isLoginMode = true; // State for login/register modal

        // Back to Top Button
        const backToTopButton = document.getElementById('back-to-top');

        // --- Utility Functions ---
        function formatPrice(price) {
            return `Rs.${price.toLocaleString('en-IN')}`;
        }

        function getRatingStars(rating) {
            let ratingHtml = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            for (let i = 0; i < fullStars; i++) {
                ratingHtml += '<i class="fas fa-star"></i>';
            }
            if (hasHalfStar) {
                ratingHtml += '<i class="fas fa-star-half-alt"></i>';
            }
            for (let i = 0; i < (5 - fullStars - (hasHalfStar ? 1 : 0)); i++) {
                ratingHtml += '<i class="far fa-star"></i>';
            }
            return ratingHtml;
        }

        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
        }

        function saveCurrentUser() {
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUserGreeting();
        }

        function saveUsers() {
            localStorage.setItem('users', JSON.stringify(users));
        }

        // --- UI Update Functions ---
        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCountSpan.textContent = totalItems;
            cartCountSpan.style.display = totalItems > 0 ? 'flex' : 'none';
        }

        function updateUserGreeting() {
            if (currentUser) {
                userGreeting.textContent = `Hi, ${currentUser.username}!`;
                userGreeting.style.display = 'inline-block';
                loginBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i>';
                loginBtn.title = 'Logout';
            } else {
                userGreeting.textContent = '';
                userGreeting.style.display = 'none';
                loginBtn.innerHTML = '<i class="fas fa-user-circle"></i>';
                loginBtn.title = 'Login / Register';
            }
        }

        function renderProducts() {
            // Clear existing products from all grids
            smartphonesGrid.innerHTML = '';
            laptopsGrid.innerHTML = '';
            audioGrid.innerHTML = '';

            // Iterate through each category and render its products
            for (const categoryName in categoriesData) {
                const productsArray = categoriesData[categoryName];
                let targetGrid;

                // Determine which grid to append products to
                if (categoryName === "Smartphones") {
                    targetGrid = smartphonesGrid;
                } else if (categoryName === "Laptops") {
                    targetGrid = laptopsGrid;
                } else if (categoryName === "Audio Devices") {
                    targetGrid = audioGrid;
                } else {
                    console.warn(`No specific grid found for category: ${categoryName}`);
                    continue; // Skip if no target grid
                }

                productsArray.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.classList.add('product-card');
                    productCard.dataset.productId = product.id;

                    productCard.innerHTML = `
                        <div class="product-image">
                            <img src="${product.image}" alt="${product.name}" onerror="this.onerror=null; this.src='https://placehold.co/600x400/CCCCCC/000000?text=Image+Not+Found';">
                        </div>
                        <div class="product-info">
                            <div class="product-category">${product.category}</div>
                            <h3 class="product-title">${product.name}</h3>
                            <div class="product-price">
                                ${formatPrice(product.price)}
                                ${product.oldPrice && product.oldPrice !== 0 ? `<span>${formatPrice(product.oldPrice)}</span>` : ''}
                            </div>
                            <div class="product-rating">
                                ${getRatingStars(product.rating)}
                            </div>
                            <button class="add-to-cart" data-product-id="${product.id}">Add to Cart</button>
                        </div>
                    `;
                    targetGrid.appendChild(productCard);
                });
            }

            // Re-attach event listeners for add to cart buttons
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', handleAddToCartClick);
            });
            // Re-attach event listeners for quick view
            document.querySelectorAll('.product-image').forEach(imageDiv => {
                imageDiv.addEventListener('click', handleProductImageClick);
            });

            // Initialize intersection observer for newly rendered product cards
            const productFaders = document.querySelectorAll('.product-card');
            const productAppearOptions = {
                threshold: 0.1,
                rootMargin: "0px 0px -50px 0px"
            };

            const productAppearOnScroll = new IntersectionObserver(function(entries, observer) {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) {
                        return;
                    } else {
                        entry.target.style.opacity = 1;
                        entry.target.style.transform = 'translateY(0)';
                        entry.target.style.transition = 'opacity 0.8s ease-out, transform 0.8s ease-out';
                        observer.unobserve(entry.target);
                    }
                });
            }, productAppearOptions);

            productFaders.forEach(fader => {
                fader.style.opacity = 0;
                fader.style.transform = 'translateY(30px)';
                appearOnScroll.observe(fader);
            });
        }


        function renderCartItems() {
            cartItemsContainer.innerHTML = '';
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="empty-cart-message">Your cart is empty. Start shopping!</p>';
                cartSubtotalSpan.textContent = formatPrice(0);
                cartShippingSpan.textContent = formatPrice(0);
                cartTotalSpan.textContent = formatPrice(0);
                checkoutBtn.disabled = true;
                checkoutBtn.style.opacity = 0.6;
                checkoutBtn.style.cursor = 'not-allowed';
                return;
            }

            let subtotal = 0;
            const shippingCost = 500; // Example fixed shipping cost

            cart.forEach(item => {
                const product = products.find(p => p.id === item.productId);
                if (!product) return; // Should not happen if product IDs are consistent

                const itemTotal = product.price * item.quantity;
                subtotal += itemTotal;

                const cartItemDiv = document.createElement('div');
                cartItemDiv.classList.add('cart-item');
                cartItemDiv.dataset.productId = product.id;

                cartItemDiv.innerHTML = `
                    <div class="cart-item-image">
                        <img src="${product.image}" alt="${product.name}" onerror="this.onerror=null; this.src='https://placehold.co/80x80/CCCCCC/000000?text=No+Image';">
                    </div>
                    <div class="cart-item-details">
                        <h4>${product.name}</h4>
                        <p>${product.category}</p>
                        <div class="cart-item-price">${formatPrice(product.price)} each</div>
                    </div>
                    <div class="cart-item-quantity-controls">
                        <button class="decrease-quantity" data-product-id="${product.id}">-</button>
                        <input type="number" value="${item.quantity}" min="1" data-product-id="${product.id}" class="cart-quantity-input">
                        <button class="increase-quantity" data-product-id="${product.id}">+</button>
                    </div>
                    <button class="remove-from-cart" data-product-id="${product.id}"><i class="fas fa-trash"></i></button>
                `;
                cartItemsContainer.appendChild(cartItemDiv);
            });

            cartSubtotalSpan.textContent = formatPrice(subtotal);
            cartShippingSpan.textContent = formatPrice(shippingCost);
            cartTotalSpan.textContent = formatPrice(subtotal + shippingCost);
            checkoutBtn.disabled = false;
            checkoutBtn.style.opacity = 1;
            checkoutBtn.style.cursor = 'pointer';

            // Attach event listeners for quantity controls and remove buttons
            document.querySelectorAll('.decrease-quantity').forEach(btn => {
                btn.addEventListener('click', handleQuantityChange);
            });
            document.querySelectorAll('.increase-quantity').forEach(btn => {
                btn.addEventListener('click', handleQuantityChange);
            });
            document.querySelectorAll('.cart-quantity-input').forEach(input => {
                input.addEventListener('change', handleQuantityInputChange);
            });
            document.querySelectorAll('.remove-from-cart').forEach(btn => {
                btn.addEventListener('click', handleRemoveFromCart);
            });
        }

        // --- Event Handlers ---

        // Mobile menu toggle
        mobileMenuBtn.addEventListener('click', () => {
            navMenu.classList.toggle('active');
            mobileMenuBtn.innerHTML = navMenu.classList.contains('active') ?
                '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
        });

        // Smooth scrolling for navigation links (not applicable for external links)
        // This page primarily has external links in its nav

        // Add to cart from product card
        function handleAddToCartClick(e) {
            e.stopPropagation(); // Prevent quick view modal from opening
            const productId = e.target.dataset.productId;
            const productToAdd = products.find(p => p.id === productId);

            if (productToAdd) {
                const existingItem = cart.find(item => item.productId === productId);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ productId: productId, quantity: 1 });
                }
                saveCart();

                // Animation feedback
                e.target.textContent = "Added!";
                e.target.style.backgroundColor = "var(--accent)";
                e.target.style.transform = "scale(1.05)";
                setTimeout(() => {
                    e.target.textContent = "Add to Cart";
                    e.target.style.backgroundColor = "";
                    e.target.style.transform = "";
                }, 1500);
            }
        }

        // Quick View Modal
        function handleProductImageClick(e) {
            const productCard = e.target.closest('.product-card');
            if (!productCard) return;

            const productId = productCard.dataset.productId;
            const productData = products.find(p => p.id === productId);

            if (productData) {
                modalProductImage.src = productData.image;
                modalProductImage.alt = productData.name;
                modalProductCategory.textContent = productData.category;
                modalProductTitle.textContent = productData.name;
                modalProductDescription.textContent = productData.description;

                let priceHtml = formatPrice(productData.price);
                if (productData.oldPrice && productData.oldPrice !== 0) {
                    priceHtml += ` <span>${formatPrice(productData.oldPrice)}</span>`;
                }
                modalProductPrice.innerHTML = priceHtml;
                modalProductRating.innerHTML = getRatingStars(productData.rating);

                // Store current product data for AI feature
                generateDescriptionBtn.dataset.productName = productData.name;
                generateDescriptionBtn.dataset.productDescription = productData.description;

                modalProductQuantityInput.value = 1; // Reset quantity
                modalAddToCartBtn.dataset.productId = productData.id; // Set product ID for modal's add to cart button

                quickViewModal.classList.add('active');
                document.body.style.overflow = 'hidden'; // Prevent scrolling background
            }
        }

        closeQuickViewModalBtn.addEventListener('click', () => {
            quickViewModal.classList.remove('active');
            document.body.style.overflow = '';
        });

        quickViewModal.addEventListener('click', (e) => {
            if (e.target === quickViewModal) {
                quickViewModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        decreaseModalQuantityBtn.addEventListener('click', () => {
            let currentQuantity = parseInt(modalProductQuantityInput.value);
            if (currentQuantity > 1) {
                modalProductQuantityInput.value = currentQuantity - 1;
            }
        });

        increaseModalQuantityBtn.addEventListener('click', () => {
            let currentQuantity = parseInt(modalProductQuantityInput.value);
            modalProductQuantityInput.value = currentQuantity + 1;
        });

        modalAddToCartBtn.addEventListener('click', (e) => {
            const productId = e.target.dataset.productId;
            const quantity = parseInt(modalProductQuantityInput.value);
            const productToAdd = products.find(p => p.id === productId);

            if (productToAdd) {
                const existingItem = cart.find(item => item.productId === productId);
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    cart.push({ productId: productId, quantity: quantity });
                }
                saveCart();

                // Animation feedback
                e.target.textContent = `Added ${quantity} to Cart!`;
                e.target.style.backgroundColor = "var(--accent)";
                setTimeout(() => {
                    e.target.textContent = "Add to Cart";
                    e.target.style.backgroundColor = "";
                    quickViewModal.classList.remove('active');
                    document.body.style.overflow = '';
                }, 1500);
            }
        });

        // Gemini API Integration for Product Description Enhancement
        generateDescriptionBtn.addEventListener('click', async () => {
            const productName = generateDescriptionBtn.dataset.productName;
            const currentDescription = generateDescriptionBtn.dataset.productDescription;

            if (!productName || !currentDescription) {
                modalProductDescription.textContent = "Error: Product details not found for enhancement.";
                return;
            }

            generateDescriptionBtn.disabled = true;
            generateDescriptionBtn.textContent = "Generating... âœ¨";
            modalProductDescription.textContent = "Generating a more engaging description, please wait...";

            try {
                const prompt = `Rewrite the following product description to be more engaging and highlight its key benefits for a premium electronics store. Focus on features, user experience, and why a customer would love it. Make it sound professional and enticing.

Product Name: ${productName}
Current Description: ${currentDescription}

Enhanced Description:`;

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = ""; // Canvas will provide this at runtime
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const generatedText = result.candidates[0].content.parts[0].text;
                    modalProductDescription.textContent = generatedText;
                } else {
                    modalProductDescription.textContent = "Failed to generate description. Please try again.";
                    console.error("Gemini API response structure unexpected:", result);
                }
            } catch (error) {
                modalProductDescription.textContent = "An error occurred while generating the description. Please try again.";
                console.error("Error calling Gemini API:", error);
            } finally {
                generateDescriptionBtn.disabled = false;
                generateDescriptionBtn.textContent = "âœ¨ Enhance Description";
            }
        });


        // Shopping Cart Modal
        document.getElementById('cartBtn').addEventListener('click', () => {
            renderCartItems();
            cartModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        closeCartModalBtn.addEventListener('click', () => {
            cartModal.classList.remove('active');
            document.body.style.overflow = '';
        });

        cartModal.addEventListener('click', (e) => {
            if (e.target === cartModal) {
                cartModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        function handleQuantityChange(e) {
            const productId = e.target.dataset.productId;
            const inputElement = document.querySelector(`.cart-quantity-input[data-product-id="${productId}"]`);
            let currentQuantity = parseInt(inputElement.value);

            if (e.target.classList.contains('decrease-quantity')) {
                if (currentQuantity > 1) {
                    currentQuantity--;
                }
            } else if (e.target.classList.contains('increase-quantity')) {
                currentQuantity++;
            }
            inputElement.value = currentQuantity;
            updateCartItemQuantity(productId, currentQuantity);
        }

        function handleQuantityInputChange(e) {
            const productId = e.target.dataset.productId;
            let currentQuantity = parseInt(e.target.value);
            if (isNaN(currentQuantity) || currentQuantity < 1) {
                currentQuantity = 1; // Default to 1 if invalid input
                e.target.value = 1;
            }
            updateCartItemQuantity(productId, currentQuantity);
        }

        function updateCartItemQuantity(productId, newQuantity) {
            const itemIndex = cart.findIndex(item => item.productId === productId);
            if (itemIndex > -1) {
                cart[itemIndex].quantity = newQuantity;
                saveCart();
                renderCartItems(); // Re-render cart to update totals
            }
        }

        function handleRemoveFromCart(e) {
            const productId = e.target.closest('.remove-from-cart').dataset.productId;
            cart = cart.filter(item => item.productId !== productId);
            saveCart();
            renderCartItems(); // Re-render cart to update display
        }

        checkoutBtn.addEventListener('click', () => {
            if (cart.length > 0) {
                // Simulate checkout process
                // In a real app, this would send data to a backend
                alert('Proceeding to checkout! (This is a frontend simulation)');
                cart = []; // Clear cart after checkout
                saveCart();
                cartModal.classList.remove('active');
                document.body.style.overflow = '';
            } else {
                alert('Your cart is empty!');
            }
        });

        // Login/Register Modal
        document.getElementById('loginBtn').addEventListener('click', () => {
            if (currentUser) {
                // Logout if already logged in
                currentUser = null;
                saveCurrentUser();
                alert('You have been logged out.');
            } else {
                // Open login/register modal
                isLoginMode = true;
                authModalTitle.textContent = 'Login';
                authSubmitBtn.textContent = 'Login';
                toggleAuthModeBtn.textContent = "Don't have an account? Register";
                confirmPasswordGroup.style.display = 'none'; // Hide confirm password for login
                authErrorMessage.style.display = 'none';
                authForm.reset(); // Clear form fields
                authModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        });

        closeAuthModalBtn.addEventListener('click', () => {
            authModal.classList.remove('active');
            document.body.style.overflow = '';
        });

        authModal.addEventListener('click', (e) => {
            if (e.target === authModal) {
                authModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        toggleAuthModeBtn.addEventListener('click', () => {
            isLoginMode = !isLoginMode;
            authModalTitle.textContent = isLoginMode ? 'Login' : 'Register';
            authSubmitBtn.textContent = isLoginMode ? 'Login' : 'Register';
            toggleAuthModeBtn.textContent = isLoginMode ? "Don't have an account? Register" : "Already have an account? Login";
            confirmPasswordGroup.style.display = isLoginMode ? 'none' : 'block'; // Show/hide confirm password
            authErrorMessage.style.display = 'none'; // Clear error message on mode switch
            authForm.reset(); // Clear form fields
        });

        authForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = authUsernameInput.value;
            const password = authPasswordInput.value;
            authErrorMessage.style.display = 'none';

            if (isLoginMode) {
                // Login logic
                if (users[username] && users[username].password === password) {
                    currentUser = { username: username };
                    saveCurrentUser();
                    authModal.classList.remove('active');
                    document.body.style.overflow = '';
                    alert(`Welcome back, ${username}!`);
                } else {
                    authErrorMessage.textContent = 'Invalid username or password.';
                    authErrorMessage.style.display = 'block';
                }
            } else {
                // Register logic
                const confirmPassword = authConfirmPasswordInput.value;
                if (password !== confirmPassword) {
                    authErrorMessage.textContent = 'Passwords do not match.';
                    authErrorMessage.style.display = 'block';
                    return;
                }

                if (users[username]) {
                    authErrorMessage.textContent = 'Username already exists. Please choose another.';
                    authErrorMessage.style.display = 'block';
                } else {
                    users[username] = { password: password };
                    saveUsers();
                    currentUser = { username: username };
                    saveCurrentUser();
                    authModal.classList.remove('active');
                    document.body.style.overflow = '';
                    alert(`Registration successful! Welcome, ${username}!`);
                }
            }
        });

        // Back to Top Button Functionality
        window.addEventListener('scroll', () => {
            if (window.scrollY > 400) { // Show button after scrolling 400px
                backToTopButton.classList.add('show');
            } else {
                backToTopButton.classList.remove('show');
            }
        });

        backToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Initial setup on page load
        document.addEventListener('DOMContentLoaded', () => {
            renderProducts(); // Call renderProducts on this page
            updateCartCount();
            updateUserGreeting();
        });

        // Add intersection observer for fade-in animations on scroll
        const faders = document.querySelectorAll('.section-title, .category-section h3'); // Only target elements on this page

        const appearOptions = {
            threshold: 0.1,
            rootMargin: "0px 0px -50px 0px"
        };

        const appearOnScroll = new IntersectionObserver(function(entries, appearOnScroll) {
            entries.forEach(entry => {
                if (!entry.isIntersecting) {
                    return;
                } else {
                    entry.target.style.opacity = 1;
                    entry.target.style.transform = 'translateY(0)';
                    entry.target.style.transition = 'opacity 0.8s ease-out, transform 0.8s ease-out';
                    appearOnScroll.unobserve(entry.target);
                }
            });
        }, appearOptions);

        faders.forEach(fader => {
            fader.style.opacity = 0;
            fader.style.transform = 'translateY(30px)';
            appearOnScroll.observe(fader);
        });

        // Add a subtle header shrink/shadow on scroll
        const header = document.querySelector('header');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 80) {
                header.style.padding = '12px 0';
                header.style.boxShadow = '0 6px 18px var(--shadow-medium)';
            } else {
                header.style.padding = '18px 0';
                header.style.boxShadow = '0 4px 15px var(--shadow-md)';
            }
        });

    </script>
</body>
</html>




